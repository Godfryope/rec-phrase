(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{131:function(e,t,n){"use strict";function o(e,t){var n=t.target.dataset.targetType,o="personal"===n?"moderator":"personal";t.target.classList.toggle("active"),e.getElementsByClassName("".concat(o,"-template-button"))[0].classList.toggle("active"),e.getElementsByClassName("".concat(n,"-responses-container"))[0].classList.toggle("hidden"),e.getElementsByClassName("".concat(o,"-responses-container"))[0].classList.toggle("hidden")}n.r(t);function s(e){var t=e.getElementsByClassName("response-templates-container")[0],n="new_comment"!==e.id&&!e.id.includes("edit_comment"),o=Array.from(t.getElementsByClassName("insert-template-button")),s=Array.from(t.getElementsByClassName("moderator-submit-button"));o.forEach((function(e){e.addEventListener("click",(function(e){var n=e.target.dataset.content,o=e.target.form.querySelector(".comment-textarea:not([role=combobox])");(null===o.value||""===o.value||confirm("Are you sure you want to replace your current comment draft?"))&&(o.value=n,o.dispatchEvent(new Event("input",{target:o})),o.focus(),t.classList.toggle("hidden"))}))})),s.forEach((function(e){e.addEventListener("click",(function(e){var t,o,s;e.preventDefault(),confirm("\nAre you sure you want to submit this comment as Sloan?\n\nIt will be sent immediately and users will be notified.\n\nMake sure this is the appropriate comment for the situation.\n\nThis action is not reversible.")&&(t=e.target.dataset.responseTemplateId,o=n,s=document.getElementById("comment_commentable_id").value,fetch("/comments/moderator_create",{method:"POST",headers:{Accept:"application/json","X-CSRF-Token":window.csrfToken,"Content-Type":"application/json"},body:JSON.stringify({response_template:{id:t},comment:{body_markdown:"",commentable_id:s,commentable_type:"Article",parent_id:o}})}).then((function(e){return e.json()})).then((function(e){"created"===e.status?window.location.pathname=e.path:"comment already exists"===e.status?alert("This comment already exists."):"error"===e.error&&alert("There was a problem submitting this comment: ".concat(e.status))})))}))}))}function a(e,t){var n,o=document.getElementById(t);"personal_comment"===e?n=o.getElementsByClassName("personal-responses-container")[0]:"mod_comment"===e&&(n=o.getElementsByClassName("moderator-responses-container")[0]),fetch("/response_templates?type_of=".concat(e),{method:"GET",headers:{Accept:"application/json","X-CSRF-Token":window.csrfToken,"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){o.querySelector("img.loading-img").classList.toggle("hidden"),n.innerHTML=function(e,t){return 0===e.length&&"personal_comment"===t?'\n<div class="mod-response-wrapper mod-response-wrapper-empty">\n  <p>\ud83e\udd14... It looks like you don\'t have any templates yet.</p>\n</div>\n':"personal_comment"===t?e.map((function(e){return'\n          <div class="mod-response-wrapper flex mb-4">\n            <div class="flex-1">\n              <h4>'.concat(e.title,"</h4>\n              <p>").concat(e.content,'</p>\n            </div>\n            <div class="pl-2">\n              <button class="crayons-btn crayons-btn--secondary crayons-btn--s insert-template-button" type="button" data-content="').concat(e.content,'">Insert</button>\n            </div>\n          </div>\n        ')})).join(""):"mod_comment"===t?e.map((function(e){return'\n            <div class="mod-response-wrapper mb-4 flex">\n              <div class="flex-1">\n                <h4>'.concat(e.title,"</h4>\n                <p>").concat(e.content,'</p>\n              </div>\n              <div class="flex flex-nowrap pl-2">\n                <button class="crayons-btn crayons-btn--s crayons-btn--secondary moderator-submit-button m-1" type="submit" data-response-template-id="').concat(e.id,'">Send as Mod</button>\n                <button class="crayons-btn crayons-btn--s crayons-btn--outlined insert-template-button m-1" type="button" data-content="').concat(e.content,'">Insert</button>\n              </div>\n            </div>\n          ')})).join(""):"Error \ud83d\ude1e"}(t,e),document.getElementById("response-templates-data").innerHTML=n.parentElement.innerHTML,s(o)}))}function r(e){var t=e.getElementsByClassName("response-templates-container")[0],n=""!==document.getElementById("response-templates-data").innerHTML;t.classList.toggle("hidden");var r=t.classList.contains("hidden");n&&!r?(!function(e){e.innerHTML=document.getElementById("response-templates-data").innerHTML}(t),s(e)):n||r||function(e){e.querySelector("img.loading-img").classList.toggle("hidden"),a("personal_comment",e.id)}(e),userData().moderator_for_tags.length>0?function(e){var t=e.getElementsByClassName("personal-template-button")[0],n=e.getElementsByClassName("moderator-template-button")[0];t.addEventListener("click",(function(t){o(e,t)})),n.addEventListener("click",(function(t){o(e,t)})),n.classList.remove("hidden"),n.addEventListener("click",(function(){var t=document.getElementById("response-templates-data");""!==t.innerHTML&&0===t.getElementsByClassName("moderator-responses-container")[0].childElementCount&&(e.querySelector("img.loading-img").classList.toggle("hidden"),a("mod_comment",e.id))}),{once:!0})}(e):e.getElementsByClassName("personal-template-button")[0].classList.add("hidden")}function c(e){var t=e.getElementsByClassName("response-templates-button")[0];t&&(t.addEventListener("click",(function(){r(e)})),t.dataset.hasListener="true")}function i(){var e,t,n,o=document.body.dataset.userStatus,s=document.getElementsByClassName("comment-form")[0];document.getElementById("response-templates-data")&&("logged-out"===o&&(null===(n=document.getElementsByClassName("response-templates-button")[0])||void 0===n||n.addEventListener("click",showLoginModal)),s&&"false"===s.getElementsByClassName("response-templates-button")[0].dataset.hasListener&&c(s),e=new MutationObserver((function(e){var t=Array.from(e[0].addedNodes).filter((function(e){return"FORM"===e.nodeName}));t.length>0&&c(t[0])})),(t=document.getElementById("comment-trees-container"))&&e.observe(t,{childList:!0,subtree:!0}),window.addEventListener("beforeunload",(function(){e.disconnect()})),window.InstantClick.on("change",(function(){e.disconnect()})))}window.InstantClick.on("change",(function(){i()})),i()}},[[131,89]]]);
//# sourceMappingURL=responseTemplates-2971b7dd68e92ce39471.chunk.js.map